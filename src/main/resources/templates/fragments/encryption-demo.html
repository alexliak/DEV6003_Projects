<!-- Encryption Demo Modal -->
<div th:fragment="encryptionDemo">
    <div class="modal fade" id="encryptionDemoModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title">
                        <i class="fas fa-lock"></i> Medical Data Encryption Process
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <strong>Security Notice:</strong> All medical diagnoses are encrypted using AES-256-GCM before storage.
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <h6>What you enter:</h6>
                            <div class="border p-3 bg-light" id="plainTextDisplay">
                                <code id="plainDiagnosis"></code>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h6>What gets stored in database:</h6>
                            <div class="border p-3 bg-dark text-white" style="word-break: break-all;">
                                <code id="encryptedDiagnosis"></code>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-3">
                        <div class="progress" style="height: 30px;">
                            <div class="progress-bar progress-bar-striped progress-bar-animated bg-success" 
                                 id="encryptionProgress" style="width: 0%">
                                <span class="h6">Encrypting...</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-3 text-center">
                        <small class="text-muted">
                            <i class="fas fa-info-circle"></i> 
                            Encryption happens automatically when you save. Only authorized medical staff can decrypt.
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
    function showEncryptionDemo(plainText) {
        document.getElementById('plainDiagnosis').textContent = plainText;
        document.getElementById('encryptedDiagnosis').textContent = '';
        document.getElementById('encryptionProgress').style.width = '0%';
        
        const modal = new bootstrap.Modal(document.getElementById('encryptionDemoModal'));
        modal.show();
        
        // Simulate encryption process
        setTimeout(() => {
            document.getElementById('encryptionProgress').style.width = '50%';
        }, 500);
        
        setTimeout(() => {
            document.getElementById('encryptionProgress').style.width = '100%';
            // Simulate encrypted output (in reality this happens server-side)
            const fakeEncrypted = btoa(plainText + Date.now()).substring(0, 60) + '...';
            document.getElementById('encryptedDiagnosis').textContent = fakeEncrypted;
        }, 1000);
    }
    </script>
</div>
